# Jigsaw Puzzle

子供から大人まで脳トレ系パズルゲームが流行しています。我々も遅れを取らぬよう、パズルゲームを 作ってみんなで遊ぶことにしました。

我々が考えたのはジグソーパズルのゲームで、未完成の部分を埋めるのに必要なピースを選ぶという ものです。図1(a)はパズルの枠の例です。黒が埋まっている部分、白が未完成の部分です。このパズル を完成するのに使えるピースが図1(b)のように与えられます。この中から、枠の白い部分を埋めるこ とができる黒いピースを1つ以上選択します。例えば、図2の選択例1のような組み合わせなら正解とな ります。一方、選択例2のような組み合わせではパズルは完成しないので不正解となります。また、選 択したピースが余ってしまう場合も不正解です。このように、プレイヤーは適切なピースを選択するこ とでゲームをクリアします。

そこでこのパズルゲームで用いる判定プログラムを開発することになりました。未完成のパズル、ピ ースの候補、そしてプレイヤーが選んだピースの組み合わせを入力とし、プレイヤーが適切なピースを 選ぶことができていればYESを、そうでなければNOと出力して終了するプログラムを作成してくださ い。

この問題では、パズルの枠はH × Wの配列で表し、未完成の部分を.(半角ピリオド)、完成している 部分を#(半角シャープ)によって与えます。パズルの枠の大きさは最大20 × 20とします。また、各ピ ースはh × wの配列で表し、ピースを構成する部分を#(半角シャープ)、そうでない部分を.(半角ピリ オド)によって与えます。与えられる各ピースは、元の状態から90度、180度、270度だけ回転すること ができます。また、各ピースの大きさは最大20 × 20とし、与えられるピースの数(n)は最大10とします。

![][1]

## Input

複数のデータセットが与えられます。各データセットの形式は以下のとおりです：

    1行目は、パズルの枠の大きさH(縦) W(横)(整数;半角空白区切り)
    2行目以降は、パズルの盤面を表す1行W文字の文字列H行(半角.(ピリオド)または#(シャープ))
    :
    :
    ピースの数n
    1番目のピースの配列のサイズh1(縦) w1(横)(整数;半角空白区切り)
    1番目のピースの配列を表す1行w1文字の文字列h1行
    :
    :
    プレイヤーの人数p
    1番目のプレイヤーの選択したピースの情報 k1 t1 t2 ......tk(整数;半角空白区切り)
    k1 :そのプレイヤーが選択したピースの数
    t1‾tk:プレイヤーの選択した 個のピースの番号
    :
    :

入力は２つの0を含む行で終了します。

## Output

各データセットごとに、以下を出力してください：

    1番目のプレイヤーが選択したピースの正否YESまたはNO
    2番目のプレイヤーが選択したピースの正否YESまたはNO
    :
    :
    p番目のプレイヤーが選択したピースの正否YESまたはNO

## Sample Input

    14 20
    ####################
    ###.............####
    ####..........######
    #######.....########
    ########.....#######
    ###..###......######
    ###..####......#####
    #########......#####
    ###########.....####
    ############.....###
    ###.########......##
    ###.#######...###.##
    ##...###....#####.##
    ####################
    10
    12 15
    #############..
    .##########....
    ....#####......
    .....#####.....
    .....######....
    ......######...
    ......######...
    ........#####..
    .........#####.
    .........######
    ........###...#
    .....####.....#
    3 3
    #..
    ###
    #..
    2 2
    ##
    ##
    4 10
    ....#####.
    ....######
    ...###...#
    ####.....#
    6 5
    ....#
    ..###
    #####
    ##.##
    #..##
    #..#.
    6 4
    ...#
    .###
    ####
    ##.#
    ##.#
    #...
    2 6
    ######
    .#####
    2 7
    ..#####
    #######
    2 13
    #############
    .##########..
    6 9
    #####....
    .######..
    .######..
    ..######.
    ...#####.
    ....#####
    8
    3 1 2 3
    4 1 2 3 4
    7 2 3 4 5 6 7 8
    5 2 3 10 7 8
    6 2 3 9 5 6 4
    8 2 3 4 6 9 5 4 10
    4 4 5 6 9
    5 10 2 3 4 9
    0 0

## Output for the Sample Input

    YES
    NO
    YES
    NO
    YES
    NO
    NO
    YES

* * *

Source: PC Koshien 2006, Preliminary Round , All-Japan High School Programming Contest, Aizu-Wakamatsu, Japan, 2006   
<http://www.pref.fukushima.jp/pc-concours/>

[1]: IMAGE1/jigsawPuzzle.gif
