# TETORIS

テトリスは、落ちてくるブロックを盤面上に並べて消すゲームです。ここでは、それを少しアレンジしたゲームを考えましょう。

本問題のテトリスは盤面の大きさは横5コマで、出現するブロックがすべて入るだけの高さがあります。落ちてくるブロックは直線状で、横向き、縦向きの2種類があり、長さは1から5までの5種類です。

以下に例を示します。Step(イ)からStep(ホ)までの図はブロックが落ちて消えていく様子を表したものです。Step(イ)から順にStep(ロ)、Step(ハ)と順に進んでいきます。

ブロックを落とすときに、Step(イ)のようにブロックのどこかが下に積んであるブロックに引っかかったときには、Step(ロ)のように落ちたブロックはその場所で止まります。また、ブロックを落とした結果、盤面の横一行の全てのコマにブロックが詰まった場合には、Step(ニ)で示されるように、その行のブロックが消えます。この後、消えた行の上にあるブロックが、そのままの形で1行下にしずみます(Step(ホ))。

![][1]

1ゲームは1000個以内のブロックが順に落ちてくることとします。例えば、落ちるブロックの長さが順番に横向き4コマ,横向き3コマ,縦向き2コマ,縦向き3コマで、落ちる場所が左端から1コマ目、1コマ目、4コマ目、5コマ目であった場合には、下図のStep(イ)〜(ト)のように落ち、最後に残るブロックは2コマになります。

![][2]

順番に落ちてくるブロックの情報を入力とし、全てのブロックが落ちた時に残るコマ数を出力するプログラムを作成してください。ただし、ブロックの数nは1から1000までの整数とします。ブロックの向きdは整数で、1は横向きを、2は縦向きを表します。長さpは1から5までの整数とします。ブロックの位置qは盤面上の左端から1〜5までの整数とし、横向きのブロックの場合は左端のコマの落ちる位置とします。

## Input

複数のデータセットの並びが入力として与えられます。入力の終わりはゼロひとつの行で示されます。各データセットは以下のとおりです。

    1行目   ブロックの数 n(整数)
    2行目   第1のブロックの情報 d p q(整数 整数 整数;半角空白区切り)
          各記号の意味は以下のとおりです。
          d:ブロックの向き
          p:ブロックの長さ
          q:ブロックの位置
    3行目   第2のブロックの情報
      :
    n 1行目  第nのブロックの情報

## Output

入力データセット毎に最後に残るブロックの占めるコマ数を出力します。

## Sample Input

    4
    1 4 1
    1 3 1
    2 2 4
    2 3 5
    1
    1 5 1
    7
    2 2 2
    1 4 1
    2 1 3
    1 4 1
    1 1 1
    2 5 5
    1 4 2
    0

## Output for the Sample Input

    2
    0
    6

* * *

Source: PC Koshien 2008, Preliminary Round , All-Japan High School Programming Contest, Aizu-Wakamatsu, Japan, 2008   
<http://www.pref.fukushima.jp/pc-concours/>

[1]: IMAGE1/pck200806_1.gif
[2]: IMAGE1/pck200806_2.gif
